openapi: 3.0.3
info:
  title: Cost-RAG å·¥ç¨‹é€ ä»·å’¨è¯¢æ™ºèƒ½RAGç³»ç»Ÿ API
  description: |
    Cost-RAGæ˜¯åŸºäºæˆæœ¬ä¼˜åŒ–çš„æ£€ç´¢å¢å¼ºç”Ÿæˆç³»ç»Ÿï¼Œä¸“ä¸ºå·¥ç¨‹é€ ä»·å’¨è¯¢è¡Œä¸šè®¾è®¡ã€‚
    æä¾›æ–‡æ¡£å¤„ç†ã€æ™ºèƒ½é—®ç­”ã€æˆæœ¬ä¼°ç®—å’Œå¤šé¡¹ç›®å¯¹æ¯”ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

    ## ä¸»è¦ç‰¹æ€§
    - ğŸ” æ”¯æŒå¤šæ ¼å¼æ–‡æ¡£å¤„ç†å’Œæ™ºèƒ½æ£€ç´¢
    - ğŸ’° 14çº§åˆ†éƒ¨åˆ†é¡¹å±‚çº§æˆæœ¬è®¡ç®—
    - ğŸ“Š å¤šé¡¹ç›®å¯¹æ¯”åˆ†æå’Œç›¸ä¼¼æ€§è¯„ä¼°
    - ğŸ¤– åŸºäºRAGçš„æ™ºèƒ½é—®ç­”ç³»ç»Ÿ
    - ğŸš€ é«˜æ€§èƒ½å¼‚æ­¥å¤„ç†æ¶æ„

    ## è®¤è¯æ–¹å¼
    ä½¿ç”¨JWT Bearer Tokenè¿›è¡Œè®¤è¯ï¼Œåœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ ï¼š
    ```
    Authorization: Bearer <your_jwt_token>
    ```

    ## é”™è¯¯å¤„ç†
    æ‰€æœ‰é”™è¯¯å“åº”éƒ½éµå¾ªç»Ÿä¸€æ ¼å¼ï¼š
    ```json
    {
      "success": false,
      "error": {
        "code": "ERROR_CODE",
        "message": "é”™è¯¯æè¿°",
        "details": []
      }
    }
    ```
  version: 1.0.0
  contact:
    name: Cost-RAGå¼€å‘å›¢é˜Ÿ
    email: support@cost-rag.com
    url: https://cost-rag.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
servers:
  - url: http://localhost:8000/api/v1
    description: å¼€å‘ç¯å¢ƒ
  - url: https://api.cost-rag.com/api/v1
    description: ç”Ÿäº§ç¯å¢ƒ

paths:
  # è®¤è¯ç›¸å…³
  /auth/login:
    post:
      tags:
        - è®¤è¯ç®¡ç†
      summary: ç”¨æˆ·ç™»å½•
      description: ç”¨æˆ·èº«ä»½è®¤è¯ï¼Œè¿”å›JWTè®¿é—®ä»¤ç‰Œ
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        '200':
          description: ç™»å½•æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LoginResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '422':
          $ref: '#/components/responses/ValidationError'

  /auth/refresh:
    post:
      tags:
        - è®¤è¯ç®¡ç†
      summary: åˆ·æ–°è®¿é—®ä»¤ç‰Œ
      description: ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œè·å–æ–°çš„è®¿é—®ä»¤ç‰Œ
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RefreshTokenRequest'
      responses:
        '200':
          description: ä»¤ç‰Œåˆ·æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RefreshTokenResponse'
        '401':
          $ref: '#/components/responses/UnauthorizedError'

  # æ–‡æ¡£å¤„ç†
  /documents/upload:
    post:
      tags:
        - æ–‡æ¡£å¤„ç†
      summary: ä¸Šä¼ æ–‡æ¡£
      description: |
        ä¸Šä¼ å¹¶å¤„ç†æ–‡æ¡£æ–‡ä»¶ï¼Œæ”¯æŒPDFã€Excelã€Wordã€PPTç­‰æ ¼å¼ã€‚
        ç³»ç»Ÿå°†è‡ªåŠ¨è¿›è¡ŒOCRè¯†åˆ«ã€æ–‡æœ¬æå–ã€åˆ†å—å¤„ç†å’Œå‘é‡åŒ–å­˜å‚¨ã€‚
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/DocumentUploadRequest'
      responses:
        '201':
          description: æ–‡æ¡£ä¸Šä¼ æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DocumentUploadResponse'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '413':
          description: æ–‡ä»¶å¤§å°è¶…å‡ºé™åˆ¶
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /documents:
    get:
      tags:
        - æ–‡æ¡£å¤„ç†
      summary: è·å–æ–‡æ¡£åˆ—è¡¨
      description: åˆ†é¡µè·å–ç”¨æˆ·æ–‡æ¡£åˆ—è¡¨ï¼Œæ”¯æŒæœç´¢å’Œè¿‡æ»¤
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/SizeParam'
        - $ref: '#/components/parameters/SearchParam'
        - name: document_type
          in: query
          description: æ–‡æ¡£ç±»å‹è¿‡æ»¤
          schema:
            type: string
            enum: [cost_template, industry_report, specification, drawing]
        - name: project_id
          in: query
          description: é¡¹ç›®IDè¿‡æ»¤
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DocumentListResponse'

  /documents/{document_id}:
    get:
      tags:
        - æ–‡æ¡£å¤„ç†
      summary: è·å–æ–‡æ¡£è¯¦æƒ…
      description: è·å–æŒ‡å®šæ–‡æ¡£çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¤„ç†çŠ¶æ€å’Œæå–çš„å®ä½“
      security:
        - bearerAuth: []
      parameters:
        - name: document_id
          in: path
          required: true
          description: æ–‡æ¡£ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DocumentDetailResponse'
        '404':
          $ref: '#/components/responses/NotFoundError'

    delete:
      tags:
        - æ–‡æ¡£å¤„ç†
      summary: åˆ é™¤æ–‡æ¡£
      description: åˆ é™¤æŒ‡å®šæ–‡æ¡£åŠå…¶ç›¸å…³çš„å‘é‡åŒ–æ•°æ®
      security:
        - bearerAuth: []
      parameters:
        - name: document_id
          in: path
          required: true
          description: æ–‡æ¡£ID
          schema:
            type: string
            format: uuid
      responses:
        '204':
          description: åˆ é™¤æˆåŠŸ
        '404':
          $ref: '#/components/responses/NotFoundError'

  # æˆæœ¬ä¼°ç®—
  /estimates:
    post:
      tags:
        - æˆæœ¬ä¼°ç®—
      summary: åˆ›å»ºæˆæœ¬ä¼°ç®—
      description: |
        åŸºäºé¡¹ç›®å‚æ•°åˆ›å»ºæ–°çš„æˆæœ¬ä¼°ç®—ï¼Œä½¿ç”¨14çº§å±‚çº§é€’å½’è®¡ç®—ç®—æ³•ã€‚
        ç³»ç»Ÿå°†è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„æˆæœ¬æ¨¡æ¿å¹¶è¿›è¡Œè´¨é‡è°ƒæ•´ã€‚
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateEstimateRequest'
      responses:
        '201':
          description: ä¼°ç®—åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateEstimateResponse'
        '422':
          $ref: '#/components/responses/ValidationError'

    get:
      tags:
        - æˆæœ¬ä¼°ç®—
      summary: è·å–ä¼°ç®—åˆ—è¡¨
      description: åˆ†é¡µè·å–æˆæœ¬ä¼°ç®—åˆ—è¡¨ï¼Œæ”¯æŒé¡¹ç›®ç±»å‹å’ŒçŠ¶æ€è¿‡æ»¤
      security:
        - bearerAuth: []
      parameters:
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/SizeParam'
        - name: project_type
          in: query
          description: é¡¹ç›®ç±»å‹è¿‡æ»¤
          schema:
            type: string
            enum: [office, residential, commercial, mixed]
        - name: status
          in: query
          description: ä¼°ç®—çŠ¶æ€è¿‡æ»¤
          schema:
            type: string
            enum: [draft, processing, completed, failed]
      responses:
        '200':
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EstimateListResponse'

  /estimates/{estimate_id}:
    get:
      tags:
        - æˆæœ¬ä¼°ç®—
      summary: è·å–ä¼°ç®—è¯¦æƒ…
      description: è·å–æˆæœ¬ä¼°ç®—çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬å®Œæ•´çš„14çº§åˆ†éƒ¨åˆ†é¡¹åˆ†è§£
      security:
        - bearerAuth: []
      parameters:
        - name: estimate_id
          in: path
          required: true
          description: ä¼°ç®—ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EstimateDetailResponse'
        '404':
          $ref: '#/components/responses/NotFoundError'

    put:
      tags:
        - æˆæœ¬ä¼°ç®—
      summary: æ›´æ–°ä¼°ç®—
      description: æ›´æ–°æˆæœ¬ä¼°ç®—çš„é¡¹ç›®å‚æ•°ï¼Œç³»ç»Ÿå°†é‡æ–°è®¡ç®—æˆæœ¬åˆ†è§£
      security:
        - bearerAuth: []
      parameters:
        - name: estimate_id
          in: path
          required: true
          description: ä¼°ç®—ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateEstimateRequest'
      responses:
        '200':
          description: æ›´æ–°æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EstimateDetailResponse'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '422':
          $ref: '#/components/responses/ValidationError'

  /estimates/{estimate_id}/export:
    get:
      tags:
        - æˆæœ¬ä¼°ç®—
      summary: å¯¼å‡ºä¼°ç®—
      description: å°†æˆæœ¬ä¼°ç®—å¯¼å‡ºä¸ºExcelæˆ–Markdownæ ¼å¼
      security:
        - bearerAuth: []
      parameters:
        - name: estimate_id
          in: path
          required: true
          description: ä¼°ç®—ID
          schema:
            type: string
            format: uuid
        - name: format
          in: query
          required: true
          description: å¯¼å‡ºæ ¼å¼
          schema:
            type: string
            enum: [excel, markdown]
        - name: template
          in: query
          description: å¯¼å‡ºæ¨¡æ¿æ ·å¼
          schema:
            type: string
            enum: [standard, detailed, summary]
            default: standard
      responses:
        '200':
          description: å¯¼å‡ºæˆåŠŸ
          content:
            application/vnd.openxmlformats-officedocument.spreadsheetml.sheet:
              schema:
                type: string
                format: binary
            text/markdown:
              schema:
                type: string
        '404':
          $ref: '#/components/responses/NotFoundError'

  # å¤šé¡¹ç›®å¯¹æ¯”
  /comparisons/upload:
    post:
      tags:
        - å¤šé¡¹ç›®å¯¹æ¯”
      summary: ä¸Šä¼ å¯¹æ¯”æ–‡ä»¶
      description: |
        ä¸Šä¼ å¤šé¡¹ç›®å¯¹æ¯”Excelæ–‡ä»¶ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨è§£æé¡¹ç›®æ•°æ®ã€
        éªŒè¯æ•°å­¦å…³ç³»å¹¶ç”Ÿæˆå¯¹æ¯”åˆ†æã€‚
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: å¤šé¡¹ç›®å¯¹æ¯”Excelæ–‡ä»¶
      responses:
        '201':
          description: æ–‡ä»¶å¤„ç†æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComparisonUploadResponse'
        '400':
          $ref: '#/components/responses/BadRequestError'
        '422':
          $ref: '#/components/responses/ValidationError'

  /comparisons/{comparison_id}:
    get:
      tags:
        - å¤šé¡¹ç›®å¯¹æ¯”
      summary: è·å–å¯¹æ¯”è¯¦æƒ…
      description: è·å–å¤šé¡¹ç›®å¯¹æ¯”çš„è¯¦ç»†æ•°æ®å’ŒéªŒè¯ç»“æœ
      security:
        - bearerAuth: []
      parameters:
        - name: comparison_id
          in: path
          required: true
          description: å¯¹æ¯”ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ComparisonDetailResponse'
        '404':
          $ref: '#/components/responses/NotFoundError'

  /comparisons/{comparison_id}/analyze:
    post:
      tags:
        - å¤šé¡¹ç›®å¯¹æ¯”
      summary: åˆ†æé¡¹ç›®ç›¸ä¼¼æ€§
      description: |
        åŸºäºç›®æ ‡é¡¹ç›®å‚æ•°åˆ†æä¸å¯¹æ¯”åº“ä¸­é¡¹ç›®çš„ç›¸ä¼¼æ€§ï¼Œ
        ç”Ÿæˆæˆæœ¬è°ƒæ•´å»ºè®®å’Œé£é™©è¯„ä¼°ã€‚
      security:
        - bearerAuth: []
      parameters:
        - name: comparison_id
          in: path
          required: true
          description: å¯¹æ¯”ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SimilarityAnalysisRequest'
      responses:
        '200':
          description: åˆ†æå®Œæˆ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SimilarityAnalysisResponse'
        '404':
          $ref: '#/components/responses/NotFoundError'
        '422':
          $ref: '#/components/responses/ValidationError'

  # RAGæŸ¥è¯¢
  /queries:
    post:
      tags:
        - RAGæŸ¥è¯¢
      summary: æäº¤æ™ºèƒ½æŸ¥è¯¢
      description: |
        æäº¤è‡ªç„¶è¯­è¨€æŸ¥è¯¢ï¼Œç³»ç»Ÿä½¿ç”¨RAGæŠ€æœ¯æ£€ç´¢ç›¸å…³æ–‡æ¡£
        å¹¶ç”Ÿæˆæ™ºèƒ½å›ç­”ï¼Œæ”¯æŒä¸Šä¸‹æ–‡å¯¹è¯ã€‚
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QueryRequest'
      responses:
        '201':
          description: æŸ¥è¯¢æäº¤æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueryResponse'
        '422':
          $ref: '#/components/responses/ValidationError'

  /queries/{query_id}:
    get:
      tags:
        - RAGæŸ¥è¯¢
      summary: è·å–æŸ¥è¯¢ç»“æœ
      description: è·å–æŸ¥è¯¢çš„è¯¦ç»†ç»“æœï¼ŒåŒ…æ‹¬å›ç­”ã€æ¥æºæ–‡æ¡£å’Œç½®ä¿¡åº¦
      security:
        - bearerAuth: []
      parameters:
        - name: query_id
          in: path
          required: true
          description: æŸ¥è¯¢ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueryDetailResponse'
        '404':
          $ref: '#/components/responses/NotFoundError'

  /queries/{query_id}/sources:
    get:
      tags:
        - RAGæŸ¥è¯¢
      summary: è·å–æŸ¥è¯¢æ¥æº
      description: è·å–æŸ¥è¯¢ç­”æ¡ˆçš„æ¥æºæ–‡æ¡£åˆ—è¡¨å’Œç›¸å…³æ€§è¯„åˆ†
      security:
        - bearerAuth: []
      parameters:
        - name: query_id
          in: path
          required: true
          description: æŸ¥è¯¢ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QuerySourcesResponse'
        '404':
          $ref: '#/components/responses/NotFoundError'

  # çŸ¥è¯†åº“
  /knowledge/entities:
    get:
      tags:
        - çŸ¥è¯†åº“
      summary: è·å–çŸ¥è¯†å›¾è°±å®ä½“
      description: è·å–çŸ¥è¯†å›¾è°±ä¸­çš„å®ä½“åˆ—è¡¨ï¼Œæ”¯æŒç±»å‹è¿‡æ»¤
      security:
        - bearerAuth: []
      parameters:
        - name: entity_type
          in: query
          description: å®ä½“ç±»å‹è¿‡æ»¤
          schema:
            type: string
            enum: [material, process, quota, regulation]
        - name: search
          in: query
          description: å®ä½“åç§°æœç´¢
          schema:
            type: string
        - $ref: '#/components/parameters/PageParam'
        - $ref: '#/components/parameters/SizeParam'
      responses:
        '200':
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EntityListResponse'

  /knowledge/search:
    get:
      tags:
        - çŸ¥è¯†åº“
      summary: è¯­ä¹‰æœç´¢
      description: åœ¨çŸ¥è¯†åº“ä¸­è¿›è¡Œè¯­ä¹‰æœç´¢ï¼Œè¿”å›ç›¸å…³çš„æ–‡æ¡£ç‰‡æ®µ
      security:
        - bearerAuth: []
      parameters:
        - name: q
          in: query
          required: true
          description: æœç´¢å…³é”®è¯
          schema:
            type: string
        - name: limit
          in: query
          description: è¿”å›ç»“æœæ•°é‡é™åˆ¶
          schema:
            type: integer
            default: 10
            minimum: 1
            maximum: 50
        - name: threshold
          in: query
          description: ç›¸ä¼¼åº¦é˜ˆå€¼
          schema:
            type: number
            format: float
            default: 0.7
            minimum: 0
            maximum: 1
      responses:
        '200':
          description: æœç´¢æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SemanticSearchResponse'

  # æˆæœ¬æ¨¡æ¿
  /templates:
    get:
      tags:
        - æˆæœ¬æ¨¡æ¿
      summary: è·å–æˆæœ¬æ¨¡æ¿åˆ—è¡¨
      description: è·å–å¯ç”¨çš„æˆæœ¬æ¨¡æ¿åˆ—è¡¨ï¼Œæ”¯æŒåœ°åŒºå’Œç±»å‹è¿‡æ»¤
      security:
        - bearerAuth: []
      parameters:
        - name: region
          in: query
          description: åœ°åŒºè¿‡æ»¤
          schema:
            type: string
        - name: project_type
          in: query
          description: é¡¹ç›®ç±»å‹è¿‡æ»¤
          schema:
            type: string
            enum: [office, residential, commercial, mixed]
        - name: is_active
          in: query
          description: æ˜¯å¦åªè¿”å›æ¿€æ´»æ¨¡æ¿
          schema:
            type: boolean
            default: true
      responses:
        '200':
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TemplateListResponse'

    post:
      tags:
        - æˆæœ¬æ¨¡æ¿
      summary: åˆ›å»ºæˆæœ¬æ¨¡æ¿
      description: åˆ›å»ºæ–°çš„æˆæœ¬æ¨¡æ¿ï¼Œéœ€è¦ç®¡ç†å‘˜æƒé™
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTemplateRequest'
      responses:
        '201':
          description: æ¨¡æ¿åˆ›å»ºæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TemplateDetailResponse'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '422':
          $ref: '#/components/responses/ValidationError'

  /templates/{template_id}:
    get:
      tags:
        - æˆæœ¬æ¨¡æ¿
      summary: è·å–æ¨¡æ¿è¯¦æƒ…
      description: è·å–æˆæœ¬æ¨¡æ¿çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬åˆ†éƒ¨åˆ†é¡¹ç»“æ„
      security:
        - bearerAuth: []
      parameters:
        - name: template_id
          in: path
          required: true
          description: æ¨¡æ¿ID
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TemplateDetailResponse'
        '404':
          $ref: '#/components/responses/NotFoundError'

  # ç³»ç»Ÿç›‘æ§
  /health:
    get:
      tags:
        - ç³»ç»Ÿç›‘æ§
      summary: å¥åº·æ£€æŸ¥
      description: ç³»ç»Ÿå¥åº·çŠ¶æ€æ£€æŸ¥ï¼Œè¿”å›å„ç»„ä»¶çŠ¶æ€
      responses:
        '200':
          description: ç³»ç»Ÿå¥åº·
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthCheckResponse'

  /metrics:
    get:
      tags:
        - ç³»ç»Ÿç›‘æ§
      summary: ç³»ç»ŸæŒ‡æ ‡
      description: è·å–ç³»ç»Ÿæ€§èƒ½å’Œä½¿ç”¨æŒ‡æ ‡ï¼Œéœ€è¦ç®¡ç†å‘˜æƒé™
      security:
        - bearerAuth: []
      responses:
        '200':
          description: è·å–æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MetricsResponse'
        '403':
          $ref: '#/components/responses/ForbiddenError'

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    # è®¤è¯ç›¸å…³
    LoginRequest:
      type: object
      required:
        - username
        - password
      properties:
        username:
          type: string
          format: email
          description: ç”¨æˆ·é‚®ç®±
          example: "user@example.com"
        password:
          type: string
          format: password
          description: ç”¨æˆ·å¯†ç 
          minLength: 8
          example: "securePassword123"

    LoginResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            access_token:
              type: string
              description: JWTè®¿é—®ä»¤ç‰Œ
              example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
            refresh_token:
              type: string
              description: åˆ·æ–°ä»¤ç‰Œ
              example: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
            token_type:
              type: string
              example: "Bearer"
            expires_in:
              type: integer
              description: è®¿é—®ä»¤ç‰Œè¿‡æœŸæ—¶é—´(ç§’)
              example: 3600
            user:
              $ref: '#/components/schemas/UserInfo'

    RefreshTokenRequest:
      type: object
      required:
        - refresh_token
      properties:
        refresh_token:
          type: string
          description: åˆ·æ–°ä»¤ç‰Œ

    RefreshTokenResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            access_token:
              type: string
              description: æ–°çš„è®¿é—®ä»¤ç‰Œ
            expires_in:
              type: integer
              description: è¿‡æœŸæ—¶é—´(ç§’)

    UserInfo:
      type: object
      properties:
        id:
          type: string
          format: uuid
        username:
          type: string
          format: email
        full_name:
          type: string
        role:
          type: string
          enum: [admin, user, viewer]
        created_at:
          type: string
          format: date-time

    # æ–‡æ¡£å¤„ç†ç›¸å…³
    DocumentUploadRequest:
      type: object
      required:
        - file
      properties:
        file:
          type: string
          format: binary
          description: ä¸Šä¼ çš„æ–‡æ¡£æ–‡ä»¶
        document_type:
          type: string
          enum: [cost_template, industry_report, specification, drawing, other]
          default: other
          description: æ–‡æ¡£ç±»å‹åˆ†ç±»
        project_id:
          type: string
          format: uuid
          description: å…³è”çš„é¡¹ç›®ID(å¯é€‰)
        description:
          type: string
          description: æ–‡æ¡£æè¿°(å¯é€‰)

    DocumentUploadResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            document_id:
              type: string
              format: uuid
            filename:
              type: string
              example: "å·¥ç¨‹é€ ä»·æ ‡å‡†.pdf"
            file_size:
              type: integer
              example: 2048576
            document_type:
              type: string
              example: "cost_template"
            processing_status:
              type: string
              enum: [uploaded, processing, completed, failed]
              example: "processing"
            upload_time:
              type: string
              format: date-time
            estimated_processing_time:
              type: integer
              description: é¢„ä¼°å¤„ç†æ—¶é—´(ç§’)
              example: 120

    DocumentListResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            documents:
              type: array
              items:
                $ref: '#/components/schemas/DocumentSummary'
            pagination:
              $ref: '#/components/schemas/PaginationInfo'

    DocumentSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        filename:
          type: string
        file_type:
          type: string
        document_type:
          type: string
        file_size:
          type: integer
        processing_status:
          type: string
        created_at:
          type: string
          format: date-time
        project_name:
          type: string
          description: å…³è”çš„é¡¹ç›®åç§°(å¦‚æœæœ‰)

    DocumentDetailResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            document:
              $ref: '#/components/schemas/DocumentSummary'
            extracted_text:
              type: string
              description: æå–çš„æ–‡æœ¬å†…å®¹(éƒ¨åˆ†)
            chunk_count:
              type: integer
              description: åˆ†å—æ•°é‡
            entities_extracted:
              type: array
              items:
                $ref: '#/components/schemas/ExtractedEntity'
            processing_details:
              type: object
              properties:
                ocr_confidence:
                  type: number
                  format: float
                parsing_method:
                  type: string
                language_detected:
                  type: string

    ExtractedEntity:
      type: object
      properties:
        entity_type:
          type: string
          enum: [material, process, quota, regulation, company, location]
        entity_name:
          type: string
        confidence:
          type: number
          format: float
          minimum: 0
          maximum: 1
        position:
          type: object
          properties:
            start:
              type: integer
            end:
              type: integer
        context:
          type: string
          description: å®ä½“ä¸Šä¸‹æ–‡

    # æˆæœ¬ä¼°ç®—ç›¸å…³
    CreateEstimateRequest:
      type: object
      required:
        - project_name
        - project_type
        - area
      properties:
        project_name:
          type: string
          description: é¡¹ç›®åç§°
          example: "å•†ä¸šç»¼åˆä½“é¡¹ç›®"
          minLength: 2
          maxLength: 255
        project_type:
          type: string
          enum: [office, residential, commercial, mixed]
          description: é¡¹ç›®ç±»å‹
        area:
          type: number
          format: float
          description: å»ºç­‘é¢ç§¯(å¹³æ–¹ç±³)
          minimum: 1
          example: 50000.0
        floors:
          type: integer
          description: æ¥¼å±‚æ•°
          minimum: 1
          maximum: 200
          example: 25
        quality_level:
          type: string
          enum: [low, medium, high]
          default: medium
          description: è´¨é‡ç­‰çº§
        location:
          type: string
          description: é¡¹ç›®ä½ç½®
          example: "åŒ—äº¬å¸‚æœé˜³åŒº"
          maxLength: 255
        template_id:
          type: string
          format: uuid
          description: æŒ‡å®šçš„æˆæœ¬æ¨¡æ¿ID(å¯é€‰)
        description:
          type: string
          description: é¡¹ç›®æè¿°
          maxLength: 1000

    CreateEstimateResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            estimate_id:
              type: string
              format: uuid
            project_name:
              type: string
            status:
              type: string
              enum: [draft, processing, completed, failed]
            estimated_completion_time:
              type: integer
              description: é¢„ä¼°å®Œæˆæ—¶é—´(ç§’)
            created_at:
              type: string
              format: date-time

    EstimateListResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            estimates:
              type: array
              items:
                $ref: '#/components/schemas/EstimateSummary'
            pagination:
              $ref: '#/components/schemas/PaginationInfo'

    EstimateSummary:
      type: object
      properties:
        id:
          type: string
          format: uuid
        project_name:
          type: string
        project_type:
          type: string
        area:
          type: number
          format: float
        status:
          type: string
        total_cost:
          type: number
          format: float
          description: æ€»é€ ä»·(å…ƒ)
        unit_cost:
          type: number
          format: float
          description: å•æ–¹é€ ä»·(å…ƒ/å¹³ç±³)
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    EstimateDetailResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            estimate:
              $ref: '#/components/schemas/EstimateSummary'
            breakdown:
              $ref: '#/components/schemas/CostBreakdown'
            template_used:
              type: object
              properties:
                template_id:
                  type: string
                  format: uuid
                template_name:
                  type: string
                region:
                  type: string
            validation_results:
              $ref: '#/components/schemas/ValidationResults'
            calculation_metadata:
              type: object
              properties:
                calculation_method:
                  type: string
                  example: "hierarchical_14_level"
                processing_time:
                  type: number
                  format: float
                quality_adjustments:
                  type: object
                  additionalProperties:
                    type: number

    CostBreakdown:
      type: object
      properties:
        total_cost:
          type: number
          format: float
          description: æ€»é€ ä»·(å…ƒ)
        unit_cost:
          type: number
          format: float
          description: å•æ–¹é€ ä»·(å…ƒ/å¹³ç±³)
        primary_sections:
          type: array
          items:
            $ref: '#/components/schemas/PrimarySection'
        secondary_sections:
          type: array
          items:
            $ref: '#/components/schemas/SecondarySection'

    PrimarySection:
      type: object
      properties:
        section_code:
          type: string
          example: "1.0"
        section_name:
          type: string
          example: "åœŸçŸ³æ–¹å·¥ç¨‹"
        unit_price:
          type: number
          format: float
          description: å•æ–¹é€ ä»·(å…ƒ/å¹³ç±³)
        total_cost:
          type: number
          format: float
          description: åˆä»·(å…ƒ)
        cost_ratio:
          type: number
          format: float
          description: å æ€»é€ ä»·æ¯”ä¾‹
        secondary_sections_count:
          type: integer
          description: åŒ…å«çš„äºŒçº§åˆ†éƒ¨æ•°é‡

    SecondarySection:
      type: object
      properties:
        section_code:
          type: string
          example: "2.1"
        section_name:
          type: string
          example: "åœŸæ–¹å¼€æŒ–"
        primary_section_code:
          type: string
          example: "2.0"
        unit_price:
          type: number
          format: float
        total_cost:
          type: number
          format: float
        cost_breakdown:
          type: object
          properties:
            material_cost:
              type: number
              format: float
            labor_cost:
              type: number
              format: float
            equipment_cost:
              type: number
              format: float

    UpdateEstimateRequest:
      type: object
      properties:
        project_name:
          type: string
          minLength: 2
          maxLength: 255
        area:
          type: number
          format: float
          minimum: 1
        quality_level:
          type: string
          enum: [low, medium, high]
        floors:
          type: integer
          minimum: 1
          maximum: 200
        location:
          type: string
          maxLength: 255
        description:
          type: string
          maxLength: 1000

    # å¤šé¡¹ç›®å¯¹æ¯”ç›¸å…³
    ComparisonUploadResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            comparison_id:
              type: string
              format: uuid
            filename:
              type: string
            projects_extracted:
              type: array
              items:
                $ref: '#/components/schemas/ExtractedProject'
            validation_results:
              $ref: '#/components/schemas/ValidationResults'
            processing_time:
              type: number
              format: float
              description: å¤„ç†æ—¶é—´(ç§’)

    ExtractedProject:
      type: object
      properties:
        project_name:
          type: string
          example: "é‡‘åœ°å•†ä¸šé¡¹ç›®"
        area:
          type: number
          format: float
          example: 89727.0
        total_cost:
          type: number
          format: float
          example: 450000000.0
        unit_cost:
          type: number
          format: float
          example: 5014.5
        quality_level:
          type: string
          example: "ä¸­"
        floors:
          type: integer
        completion_date:
          type: string
          format: date
        location:
          type: string

    ComparisonDetailResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            comparison:
              type: object
              properties:
                id:
                  type: string
                  format: uuid
                filename:
                  type: string
                upload_date:
                  type: string
                  format: date-time
            projects:
              type: array
              items:
                $ref: '#/components/schemas/ProjectComparisonData'
            validation_summary:
              $ref: '#/components/schemas/ValidationResults'

    ProjectComparisonData:
      type: object
      properties:
        project_name:
          type: string
        basic_info:
          type: object
          properties:
            area:
              type: number
              format: float
            floors:
              type: integer
            quality_level:
              type: string
            completion_date:
              type: string
              format: date
        cost_breakdown:
          type: array
          items:
            type: object
            properties:
              section_code:
                type: string
              section_name:
                type: string
              unit_cost:
                type: number
                format: float
              total_cost:
                type: number
                format: float

    SimilarityAnalysisRequest:
      type: object
      required:
        - target_project
      properties:
        target_project:
          type: object
          required:
            - area
            - project_type
          properties:
            area:
              type: number
              format: float
              minimum: 1
              example: 60000.0
            project_type:
              type: string
              enum: [office, residential, commercial, mixed]
              example: "commercial"
            location:
              type: string
              example: "ä¸Šæµ·å¸‚æµ¦ä¸œæ–°åŒº"
            quality_level:
              type: string
              enum: [low, medium, high]
              example: "high"
            floors:
              type: integer
              example: 30
        analysis_options:
          type: object
          properties:
            similarity_threshold:
              type: number
              format: float
              minimum: 0
              maximum: 1
              default: 0.7
            max_results:
              type: integer
              minimum: 1
              maximum: 20
              default: 10
            include_cost_analysis:
              type: boolean
              default: true

    SimilarityAnalysisResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            analysis_id:
              type: string
              format: uuid
            target_project:
              type: object
              properties:
                area:
                  type: number
                  format: float
                project_type:
                  type: string
                location:
                  type: string
            similar_projects:
              type: array
              items:
                $ref: '#/components/schemas/SimilarProject'
            cost_analysis:
              $ref: '#/components/schemas/CostAnalysisSummary'
            recommendations:
              type: array
              items:
                $ref: '#/components/schemas/CostRecommendation'

    SimilarProject:
      type: object
      properties:
        project_name:
          type: string
        similarity_score:
          type: number
          format: float
          minimum: 0
          maximum: 1
        area_difference:
          type: number
          format: float
          description: é¢ç§¯å·®å¼‚ç™¾åˆ†æ¯”
        cost_comparison:
          type: object
          properties:
            unit_cost_difference:
              type: number
              format: float
              description: å•æ–¹é€ ä»·å·®å¼‚(å…ƒ/å¹³ç±³)
            total_cost_estimated:
              type: number
              format: float
              description: åŸºäºç›®æ ‡é¢ç§¯çš„ä¼°ç®—æ€»é€ ä»·
        similarity_factors:
          type: array
          items:
            type: object
            properties:
              factor:
                type: string
                example: "é¡¹ç›®ç±»å‹"
              score:
                type: number
                format: float
              weight:
                type: number
                format: float

    CostAnalysisSummary:
      type: object
      properties:
            market_average_unit_cost:
              type: number
              format: float
              description: å¸‚åœºå¹³å‡å•æ–¹é€ ä»·
            target_project_estimate:
              type: object
              properties:
                unit_cost:
                  type: number
                  format: float
                total_cost:
                  type: number
                  format: float
            cost_range:
              type: object
              properties:
                minimum:
                  type: number
                  format: float
                maximum:
                  type: number
                  format: float
                average:
                  type: number
                  format: float
            confidence_level:
              type: number
              format: float
              minimum: 0
              maximum: 1

    CostRecommendation:
      type: object
      properties:
        type:
          type: string
          enum: [cost_optimization, risk_alert, market_insight]
        title:
          type: string
        description:
          type: string
        priority:
          type: string
          enum: [high, medium, low]
        potential_savings:
          type: number
          format: float
          description: æ½œåœ¨èŠ‚çº¦é‡‘é¢(å…ƒ)
        action_items:
          type: array
          items:
            type: string

    # RAGæŸ¥è¯¢ç›¸å…³
    QueryRequest:
      type: object
      required:
        - question
      properties:
        question:
          type: string
          description: æŸ¥è¯¢é—®é¢˜
          minLength: 5
          maxLength: 1000
          example: "æ··å‡åœŸC30çš„å•ä»·æ˜¯å¤šå°‘ï¼Ÿ"
        context_type:
          type: string
          enum: [cost_estimation, material_info, regulation, general]
          default: general
          description: æŸ¥è¯¢ä¸Šä¸‹æ–‡ç±»å‹
        max_results:
          type: integer
          minimum: 1
          maximum: 20
          default: 5
          description: æœ€å¤§æ£€ç´¢ç»“æœæ•°é‡
        include_sources:
          type: boolean
          default: true
          description: æ˜¯å¦åŒ…å«æ¥æºä¿¡æ¯
        conversation_id:
          type: string
          format: uuid
          description: å¯¹è¯ID(ç”¨äºä¸Šä¸‹æ–‡è¿ç»­æ€§)

    QueryResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            query_id:
              type: string
              format: uuid
            question:
              type: string
            status:
              type: string
              enum: [processing, completed, failed]
            created_at:
              type: string
              format: date-time
            estimated_completion_time:
              type: integer
              description: é¢„ä¼°å®Œæˆæ—¶é—´(ç§’)

    QueryDetailResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            query:
              type: object
              properties:
                id:
                  type: string
                  format: uuid
                question:
                  type: string
                status:
                  type: string
                created_at:
                  type: string
                  format: date-time
                completed_at:
                  type: string
                  format: date-time
            answer:
              type: object
              properties:
                content:
                  type: string
                  description: ç”Ÿæˆçš„å›ç­”å†…å®¹
                confidence_score:
                  type: number
                  format: float
                  minimum: 0
                  maximum: 1
                sources_cited:
                  type: integer
                  description: å¼•ç”¨çš„æ¥æºæ•°é‡
                response_time:
                  type: number
                  format: float
                  description: å“åº”æ—¶é—´(ç§’)
            sources:
              type: array
              items:
                $ref: '#/components/schemas/QuerySource'
            metadata:
              type: object
              properties:
                retrieval_method:
                  type: string
                  enum: [hybrid, semantic, keyword]
                model_used:
                  type: string
                tokens_used:
                  type: integer

    QuerySource:
      type: object
      properties:
        document_id:
          type: string
          format: uuid
        document_name:
          type: string
        chunk_content:
          type: string
          description: ç›¸å…³æ–‡æœ¬ç‰‡æ®µ
        relevance_score:
          type: number
          format: float
          minimum: 0
          maximum: 1
        position:
          type: object
          properties:
            page:
              type: integer
            section:
              type: string

    QuerySourcesResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            query_id:
              type: string
              format: uuid
            sources:
              type: array
              items:
                $ref: '#/components/schemas/QuerySource'
            total_sources:
              type: integer

    # çŸ¥è¯†åº“ç›¸å…³
    EntityListResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            entities:
              type: array
              items:
                $ref: '#/components/schemas/KnowledgeEntity'
            pagination:
              $ref: '#/components/schemas/PaginationInfo'

    KnowledgeEntity:
      type: object
      properties:
        id:
          type: string
          format: uuid
        entity_name:
          type: string
        entity_type:
          type: string
          enum: [material, process, quota, regulation, company, location]
        description:
          type: string
        confidence_score:
          type: number
          format: float
        source_count:
          type: integer
          description: æ¥æºæ–‡æ¡£æ•°é‡
        related_entities:
          type: array
          items:
            type: object
            properties:
              entity_name:
                type: string
              relationship_type:
                type: string
              strength:
                type: number
                format: float

    SemanticSearchResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            query:
              type: string
            results:
              type: array
              items:
                type: object
                properties:
                  content:
                    type: string
                  document_name:
                    type: string
                  relevance_score:
                    type: number
                    format: float
                  chunk_id:
                    type: string
                    format: uuid
            search_metadata:
              type: object
              properties:
                total_results:
                  type: integer
                search_time:
                  type: number
                  format: float
                threshold_used:
                  type: number
                  format: float

    # æˆæœ¬æ¨¡æ¿ç›¸å…³
    TemplateListResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            templates:
              type: array
              items:
                $ref: '#/components/schemas/CostTemplate'
            pagination:
              $ref: '#/components/schemas/PaginationInfo'

    CostTemplate:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        template_type:
          type: string
        region:
          type: string
        base_year:
          type: integer
        is_active:
          type: boolean
        created_at:
          type: string
          format: date-time
        projects_count:
          type: integer
          description: ä½¿ç”¨è¯¥æ¨¡æ¿çš„é¡¹ç›®æ•°é‡

    CreateTemplateRequest:
      type: object
      required:
        - name
        - region
        - base_year
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 255
        template_type:
          type: string
          enum: [government, enterprise, custom]
        region:
          type: string
          maxLength: 100
        base_year:
          type: integer
          minimum: 2000
          maximum: 2030
        description:
          type: string
          maxLength: 1000
        sections:
          type: array
          items:
            $ref: '#/components/schemas/TemplateSection'

    TemplateSection:
      type: object
      required:
        - section_code
        - section_name
        - section_level
      properties:
        section_code:
          type: string
          example: "1.0"
        section_name:
          type: string
          example: "åœŸçŸ³æ–¹å·¥ç¨‹"
        section_level:
          type: integer
          enum: [1, 2]
        parent_section_code:
          type: string
        base_unit_price:
          type: number
          format: float
          minimum: 0
        unit:
          type: string
          example: "å…ƒ/å¹³ç±³"
        description:
          type: string

    TemplateDetailResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          $ref: '#/components/schemas/CostTemplateDetail'

    CostTemplateDetail:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        template_type:
          type: string
        region:
          type: string
        base_year:
          type: integer
        is_active:
          type: boolean
        description:
          type: string
        sections:
          type: array
          items:
            $ref: '#/components/schemas/TemplateSection'
        usage_statistics:
          type: object
          properties:
            projects_count:
              type: integer
            last_used:
              type: string
              format: date-time
            average_accuracy:
              type: number
              format: float

    # ç³»ç»Ÿç›‘æ§ç›¸å…³
    HealthCheckResponse:
      type: object
      properties:
        status:
          type: string
          enum: [healthy, degraded, unhealthy]
        timestamp:
          type: string
          format: date-time
        components:
          type: object
          additionalProperties:
            type: object
            properties:
              status:
                type: string
                enum: [healthy, unhealthy]
              response_time:
                type: number
                format: float
              last_check:
                type: string
                format: date-time
        version:
          type: string
        uptime:
          type: number
          description: è¿è¡Œæ—¶é—´(ç§’)

    MetricsResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            system_metrics:
              type: object
              properties:
                cpu_usage:
                  type: number
                  format: float
                memory_usage:
                  type: number
                  format: float
                disk_usage:
                  type: number
                  format: float
            api_metrics:
              type: object
              properties:
                requests_per_minute:
                  type: number
                average_response_time:
                  type: number
                  format: float
                error_rate:
                  type: number
                  format: float
            business_metrics:
              type: object
              properties:
                total_documents:
                  type: integer
                total_estimates:
                  type: integer
                active_users:
                  type: integer

    # é€šç”¨ç»„ä»¶
    PaginationInfo:
      type: object
      properties:
        page:
          type: integer
          minimum: 1
          example: 1
        size:
          type: integer
          minimum: 1
          maximum: 100
          example: 20
        total:
          type: integer
          minimum: 0
          example: 150
        pages:
          type: integer
          minimum: 0
          example: 8
        has_next:
          type: boolean
        has_prev:
          type: boolean

    ValidationResults:
      type: object
      properties:
        is_valid:
          type: boolean
        errors:
          type: array
          items:
            type: string
        warnings:
          type: array
          items:
            type: string
        mathematical_validation:
          type: object
          properties:
            section_14_validation:
              type: boolean
            hierarchy_validations:
              type: array
              items:
                type: object
                properties:
                  section_code:
                    type: string
                  is_valid:
                    type: boolean
                  expected_value:
                    type: number
                  actual_value:
                    type: number

    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: object
          properties:
            code:
              type: string
              example: "VALIDATION_ERROR"
            message:
              type: string
              example: "è¯·æ±‚å‚æ•°éªŒè¯å¤±è´¥"
            details:
              type: array
              items:
                type: object
                properties:
                  field:
                    type: string
                  message:
                    type: string
        timestamp:
          type: string
          format: date-time
        request_id:
          type: string
          format: uuid

  parameters:
    PageParam:
      name: page
      in: query
      description: é¡µç ï¼Œä»1å¼€å§‹
      schema:
        type: integer
        minimum: 1
        default: 1

    SizeParam:
      name: size
      in: query
      description: æ¯é¡µæ•°é‡ï¼Œæœ€å¤§100
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 20

    SearchParam:
      name: search
      in: query
      description: æœç´¢å…³é”®è¯
      schema:
        type: string
        minLength: 1
        maxLength: 100

  responses:
    BadRequestError:
      description: è¯·æ±‚å‚æ•°é”™è¯¯
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    UnauthorizedError:
      description: æœªæˆæƒè®¿é—®
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    ForbiddenError:
      description: ç¦æ­¢è®¿é—®
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    NotFoundError:
      description: èµ„æºä¸å­˜åœ¨
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

    ValidationError:
      description: æ•°æ®éªŒè¯å¤±è´¥
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

tags:
  - name: è®¤è¯ç®¡ç†
    description: ç”¨æˆ·è®¤è¯å’Œæˆæƒç›¸å…³æ¥å£
  - name: æ–‡æ¡£å¤„ç†
    description: æ–‡æ¡£ä¸Šä¼ ã€è§£æå’Œç®¡ç†
  - name: æˆæœ¬ä¼°ç®—
    description: é¡¹ç›®æˆæœ¬ä¼°ç®—å’Œåˆ†æ
  - name: å¤šé¡¹ç›®å¯¹æ¯”
    description: å¤šé¡¹ç›®å¯¹æ¯”å’Œç›¸ä¼¼æ€§åˆ†æ
  - name: RAGæŸ¥è¯¢
    description: æ™ºèƒ½é—®ç­”å’Œæ£€ç´¢
  - name: çŸ¥è¯†åº“
    description: çŸ¥è¯†å›¾è°±å’Œè¯­ä¹‰æœç´¢
  - name: æˆæœ¬æ¨¡æ¿
    description: æˆæœ¬æ¨¡æ¿ç®¡ç†
  - name: ç³»ç»Ÿç›‘æ§
    description: ç³»ç»Ÿå¥åº·æ£€æŸ¥å’ŒæŒ‡æ ‡ç›‘æ§